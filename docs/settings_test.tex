% table of contents
\usepackage{tocloft}
\renewcommand{\cfttoctitlefont}{\hfill\large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill\hfill}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\setlength\cftbeforetoctitleskip{-22pt}
\setlength\cftaftertoctitleskip{15pt}
\setcounter{secnumdepth}{4}

% searchable and copyable
\usepackage{cmap}

% Times New Roman
\usepackage{pscyr}
\renewcommand{\rmdefault}{ftm}

% Links
\def\UrlBreaks{\do\/\do-\do\_}
\usepackage[nottoc]{tocbibind} % for bib link
\usepackage[numbers]{natbib}
\renewcommand*{\bibnumfmt}[1]{#1.}
%% Captions
\usepackage[figurename=Рисунок,labelsep=endash,
            justification=centering]{caption}
\usepackage{subcaption}
\usepackage{hyphenat}


%% Images
\usepackage{graphicx}
\usepackage{wrapfig}


% Lists
\usepackage{enumitem}
\renewcommand{\labelitemi}{$-$}
% вторые и след строки выровнены по первой
\setlist{nosep, labelindent=\parindent, leftmargin=*}
% вторые и след строки выровнены по левому краю
%\setlist{nosep, leftmargin=\parindent, wide}
\usepackage{multicol}
%
% Comments
\usepackage{comment}
%
% Text
\usepackage{amstext}
\usepackage{ulem}
\renewcommand{\ULdepth}{1.5pt}

% Formulas
\DeclareMathOperator*{\argmax}{argmax}

% Tabulars
\usepackage{threeparttable}
\usepackage{csvsimple}
\usepackage{longtable,ltcaption,booktabs}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{array}

% PDF
\usepackage{pdfpages}

% cites
\usepackage{natbib}
\bibpunct{[}{]}{;}{n}{}{}

% Listings
\usepackage{listings}
\usepackage[newfloat]{minted}
\usepackage{verbatim}
\usepackage[framemethod=tikz]{mdframed}

\mdfdefinestyle{mymdstyle}{
    innerleftmargin=0mm,
    innerrightmargin=0mm,
    innertopmargin=-4pt,
    innerbottommargin=-9pt,
    splittopskip=\baselineskip,
    hidealllines=true,
    middleextra={
      \node[anchor=west] at (O|-P)
        {\lstlistingname~\thelstlisting~(продолжение)};
        },
    secondextra={
      \node[anchor=west] at (O|-P)
        {\lstlistingname~\thelstlisting~(продолжение)};},
}

\surroundwithmdframed[style=mymdstyle]{lstlisting}
\newmdenv[style=mymdstyle]{mdlisting}

\newcommand{\mylisting}[4] {
    \noindent
    \begin{minipage}{\linewidth}
        \captionsetup{justification=raggedright,singlelinecheck=off}
        \begin{lstinputlisting}[
            caption={#1},
            label={lst:#2},
            linerange={#3}
        ]{#4}
        \end{lstinputlisting}
    \end{minipage}
}

\newcommand{\mybreaklisting}[4]{
    \begin{mdlisting}
        \captionsetup{justification=raggedright,singlelinecheck=off}
        \lstinputlisting[label=lst:#2, caption=#1,
        linerange=#3]{}
    \end{mdlisting}
}
